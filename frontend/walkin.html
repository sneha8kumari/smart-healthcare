<!DOCTYPE html>
<html>
<head>
    <title>Walk-in Token</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <!-- QR Code Script -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
    <link rel="stylesheet" href="style.css">

</head>
<body class="container mt-4">

<h1>Take Walk-in Token</h1>

<label>User ID:</label>
<input id="user_id" class="form-control"><br>

<label>Doctor ID (optional):</label>
<input id="doctor_id" class="form-control"><br>

<button class="btn btn-primary" onclick="takeToken()">Get Token</button>

<h3 id="result" class="mt-3"></h3>

<!-- â­ QR Code will appear here -->
<div id="qrcode" class="mt-3"></div>

<script>
// ------------------------------
// Generate Walk-In Token
// ------------------------------
async function takeToken() {
    const user_id = document.getElementById("user_id").value;
    const doctor_id = document.getElementById("doctor_id").value;

    let res = await fetch("http://localhost:5000/api/walkin", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ user_id, doctor_id })
    });

    let data = await res.json();

    document.getElementById("result").innerText =
        "Your Token Number = " + data.token_no;

    // ------------------------------
    // Generate QR Code
    // ------------------------------
    QRCode.toCanvas(
        document.getElementById("qrcode"),
        "Token Number: " + data.token_no,
        function(err) {
            if (err) console.error(err);
        }
    );
}
</script>

</body>
</html>
